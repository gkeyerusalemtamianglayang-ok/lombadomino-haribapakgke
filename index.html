<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pendaftaran Lomba Domino GKE</title>
<style>
  body { font-family: sans-serif; background: #f8fafc; margin: 0; color: #1f2937; }
  .container { max-width: 720px; margin: 30px auto; background: #fff; padding: 24px;
                border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,.08);}
  h1 { text-align: center; margin: 0 0 8px; }
  form { display: grid; gap: 12px; margin: 18px 0; }
  input, select, button { padding: 10px; border-radius: 8px; border: 1px solid #d1d5db; }
  button { background: #2563eb; color: #fff; font-weight: 600; border: none; cursor: pointer; }
  button:hover { opacity:.9; }
  table { width:100%; border-collapse:collapse; }
  th, td { border-bottom:1px solid #e5e7eb; padding:8px; text-align:left; }
  th { background:#f1f5f9; }
  tr:nth-child(even){background:#f9fafb;}
</style>
</head>
<body>
<div class="container">
  <h1>Pendaftaran Lomba Domino Hari Bapak GKE 2025</h1>
  <h1>CARES GKE TAMIANG LAYANG UTARA</h1>

  <!-- Form kirim ke Apps Script -->
  <form id="form">
    <input id="nama" placeholder="Nama peserta" required />
    <select id="jemaat" required>
      <option value="">-- Pilih Asal Jemaat --</option>
      <option>Jemaat GKE Yerusalem Tamiang Layang</option>
      <option>Jemaat GKE Sumur</option>
      <option>Jemaat GKE Jaweten</option>
      <option>Jemaat GKE Karang Langit</option>
      <option>Jemaat GKE Katambung</option>
      <option>Jemaat GKE Haringen</option>
    </select>
    <button type="submit">Tambah</button>
  </form>

  <p id="msg" style="text-align:center;color:green;font-weight:600;"></p>

  <h3>Daftar Peserta</h3>
  <table>
    <thead>
      <tr><th>No</th><th>Nama</th><th>Asal Jemaat</th></tr>
    </thead>
    <tbody id="tbody">
      <tr><td colspan="3" style="text-align:center;color:#9ca3af;">Memuat data...</td></tr>
    </tbody>
  </table>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwb5mVy2ZkMNypF1EtYsreBwbfMD7aiO-nWAgEncxlY9oDjoVfID9J6bzbYGJEx37dubw/exec";

// ambil data dari sheet
async function muatData(){
  const tbody = document.getElementById("tbody");
  tbody.innerHTML = "<tr><td colspan='3' style='text-align:center;color:#9ca3af;'>Memuat data...</td></tr>";
  try {
    const res = await fetch("https://corsproxy.io/?" + SCRIPT_URL);
    const data = await res.json();
    if (!data.length) {
      tbody.innerHTML = "<tr><td colspan='3' style='text-align:center;color:#9ca3af;'>Belum ada peserta.</td></tr>";
      return;
    }
    tbody.innerHTML = data.map((d,i)=>`
      <tr>
        <td>${i+1}</td>
        <td>${d.nama}</td>
        <td>${d.jemaat}</td>
      </tr>`).join('');
  } catch(err){
    console.error("Gagal memuat data:", err);
    tbody.innerHTML = "<tr><td colspan='3' style='text-align:center;color:red;'>Gagal memuat data.</td></tr>";
  }
}

// kirim data baru
document.getElementById("form").addEventListener("submit", async e=>{
  e.preventDefault();
  const nama = document.getElementById("nama").value.trim();
  const jemaat = document.getElementById("jemaat").value;
  const formData = new FormData();
  formData.append("nama", nama);
  formData.append("jemaat", jemaat);
  try{
    await fetch(SCRIPT_URL, { method:"POST", body:formData, mode:"no-cors" });
    document.getElementById("msg").textContent = "✅ Data berhasil dikirim!";
    e.target.reset();
    setTimeout(muatData, 2000);
  }catch(err){
    document.getElementById("msg").textContent = "❌ Gagal kirim data.";
  }
});

muatData();
</script>
</body>
</html>
